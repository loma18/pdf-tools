# PDF书签工具 - 用户使用指南

## 🎯 软件简介

PDF书签工具是一款智能化的PDF文档处理工具，提供两大核心功能：
- **自动加书签**：智能识别PDF文档中的标题结构，自动生成多层级书签目录
- **自动提取书签**：提取PDF文档中已有的书签信息，导出为多种格式文件

## 📦 安装说明

### 方式一：直接运行（推荐）
1. 下载并解压软件包
2. 双击 `快速开始.bat` 选择"运行开发版本"
3. 或直接双击 `PDF书签工具.exe`（如果有打包版本）

### 方式二：手动安装
1. 确保已安装 Node.js (版本 >= 14)
2. 确保已安装 Python (版本 >= 3.7)
3. 运行 `npm install` 安装依赖
4. 运行 `npm start` 启动应用

## 🖥️ 界面布局

```
┌─────────────────────────────────────────┐
│ PDF书签工具                              │
│ 自动识别PDF标题并生成书签目录             │
├─────────────────────────────────────────┤
│ [自动加书签] [自动提取书签]              │
├─────────────────────────────────────────┤
│ 📁 文件选择                             │
│   输入PDF文件: [选择文件...] [浏览...]   │
│   输出文件路径: [自动生成...] [浏览...]   │
├─────────────────────────────────────────┤
│ ⚙️ 处理选项                             │
│   ☐ 启用大模型语义过滤                  │
│   ☑️ 启用字体大小过滤                    │
│   字体大小阈值: [自动检测]               │
│   ☑️ 启用增强本地过滤                    │
│   ☐ 启用调试模式                        │
│   ☑️ 启用X坐标过滤                       │
│   X坐标容差(px): [5.0]                  │
├─────────────────────────────────────────┤
│ [▶️ 开始处理] [⏹️ 停止] [📂 打开文件夹]  │
├─────────────────────────────────────────┤
│ 📊 处理进度: ████████░░ 80%             │
├─────────────────────────────────────────┤
│ 📋 处理日志                             │
│ [时间] 开始处理PDF文件...                │
│ [时间] 找到 15 个潜在标题...             │
│ [时间] ✅ 处理完成！                     │
└─────────────────────────────────────────┘
```

## 🔧 功能使用

### 自动加书签功能

#### 第一步：选择PDF文件
- 点击"选择PDF文件"旁的"浏览..."按钮
- 选择需要添加书签的PDF文件
- 支持拖拽文件到输入框（开发中）

#### 第二步：设置输出路径
- 系统会自动生成输出文件名（原文件名_with_bookmarks.pdf）
- 可手动修改输出路径
- 点击"浏览..."按钮选择自定义保存位置

#### 第三步：配置处理选项

**启用大模型语义过滤**：
- ☐ 默认禁用：使用本地规则进行标题识别和过滤
- ☑️ 启用：使用AI进行高级语义理解和结构优化（需要网络连接）

**启用字体大小过滤**：
- ☑️ 默认启用：根据字体大小自动识别标题
- ☐ 禁用：不使用字体大小作为标题判断依据

**字体大小阈值**：
- 留空：自动检测最佳阈值（推荐）
- 手动设置：指定最小字体大小（如：12.0）

**启用增强本地过滤**：
- ☑️ 适用于：禁用大模型时的高质量本地处理
- ☐ 适用于：启用大模型时的基础处理

**启用调试模式**：
- ☐ 默认禁用：正常处理模式
- ☑️ 启用：生成详细的PDF标题特征分析信息，用于调试和分析

**启用X坐标过滤**：
- ✅ 适用于：标准格式文档、有统一对齐的标题
- ❌ 适用于：格式不规范的文档、多栏布局文档

**X坐标容差设置**：
- 0-3px：严格对齐要求
- 5px：默认设置，适用于大多数文档
- 10px以上：宽松对齐要求，适用于格式不规范的文档

#### 第四步：开始处理
- 点击"开始处理"按钮
- 观察进度条和日志信息
- 处理完成后可点击"打开文件夹"查看结果

### 自动提取书签功能

#### 第一步：切换到提取标签页
- 点击界面顶部的"自动提取书签"标签

#### 第二步：选择包含书签的PDF文件
- 点击"选择PDF文件"旁的"浏览..."按钮
- 选择已包含书签的PDF文件

#### 第三步：设置输出文件
- 系统会自动生成输出文件名（原文件名_bookmarks.格式）
- 可手动修改输出路径和文件名

#### 第四步：配置提取选项

**包含页面信息**：
- ☑️ 默认启用：导出文件中包含每个书签对应的页码
- ☐ 禁用：只导出书签标题和层级信息

**包含层级信息**：
- ☑️ 默认启用：导出文件中包含书签的层级结构信息
- ☐ 禁用：只导出书签标题（扁平结构）

**导出格式**：
- **JSON**：结构化数据格式，便于程序处理
- **TXT**：纯文本格式，便于阅读和编辑
- **CSV**：表格格式，可用Excel等软件打开

#### 第五步：开始提取
- 点击"开始提取"按钮
- 查看提取进度和日志信息
- 提取完成后可在"书签预览"区域查看结果
- 点击"打开文件夹"查看导出的书签文件

## 📋 导出格式说明

### JSON格式示例
```json
[
  {
    "title": "第一章 概述",
    "level": 1,
    "page": 1
  },
  {
    "title": "1.1 背景介绍", 
    "level": 2,
    "page": 2
  }
]
```

### TXT格式示例
```
PDF书签列表
==================================================

第一章 概述 (层级 1, 页面 1)
  1.1 背景介绍 (层级 2, 页面 2)
  1.2 研究意义 (层级 2, 页面 3)
```

### CSV格式示例
```csv
title,level,page
第一章 概述,1,1
1.1 背景介绍,2,2
1.2 研究意义,2,3
```

## 💡 使用技巧

### 选择合适的处理模式

**大模型模式**（需要网络）：
- ✅ 优点：识别准确度最高，能处理复杂格式
- ❌ 缺点：需要网络连接，处理速度较慢
- 🎯 适用：重要文档、复杂格式、要求最高质量

**增强本地模式**（推荐）：
- ✅ 优点：无需网络，速度快，准确度高
- ❌ 缺点：对特殊格式的处理能力有限
- 🎯 适用：大多数标准格式文档

**基础本地模式**：
- ✅ 优点：处理速度最快
- ❌ 缺点：准确度相对较低
- 🎯 适用：格式标准、要求快速处理

### 日志信息解读

- 🔍 **"找到 X 个潜在标题"**：初步识别的候选标题数量
- 📊 **"过滤后剩余 X 个"**：经过各种过滤规则后的有效标题
- ✅ **"添加了 X 个书签"**：最终成功添加到PDF的书签数量
- ❌ **错误信息**：显示具体的错误原因和建议解决方案

### 常见问题解决

**问题1：识别的标题太多/太少**
- 解决：调整字体大小阈值，或启用/禁用不同的过滤选项

**问题2：标题层级不正确**
- 解决：启用大模型语义过滤，或检查原文档的标题格式

**问题3：处理速度慢**
- 解决：禁用大模型，使用增强本地过滤模式

**问题4：提取不到书签**
- 解决：确认PDF文件确实包含书签，可以在PDF阅读器中验证

## 🔧 调试模式使用指南

启用调试模式后，系统会生成详细的分析文件（如：`pdf_debug_文件名.txt`），包含：

- **文本块分析**：每个文本块的位置、字体、大小等详细信息
- **字体统计**：文档中使用的字体类型和大小分布
- **模式匹配**：哪些文本匹配了标题模式
- **过滤过程**：每个过滤步骤的详细结果

这些信息有助于：
- 分析为什么某些标题没有被识别
- 优化字体大小阈值设置
- 了解文档的结构特征
- 调试和改进处理效果

## ⚠️ 注意事项

1. **文件备份**：处理前请备份原始PDF文件
2. **中文支持**：软件完全支持中文PDF文档
3. **文件路径**：避免使用包含特殊字符的文件路径
4. **网络连接**：大模型功能需要稳定的网络连接
5. **内存使用**：处理大型PDF文件时可能需要较多内存
6. **书签覆盖**：新生成的书签会覆盖原有书签（如果存在）

## 🆘 故障排除

### 常见错误及解决方案

**"找不到Python"**
- 确保已安装Python 3.7+
- 将Python添加到系统PATH环境变量

**"模块导入错误"**
- 运行 `pip install -r python-backend/requirements.txt`

**"文件无法打开"**
- 检查PDF文件是否损坏
- 确保文件没有被其他程序占用
- 检查文件路径是否包含特殊字符

**"处理中断"**
- 检查磁盘空间是否充足
- 确保有足够的内存
- 重启软件后重试

## 📞 技术支持

如遇到问题，请提供以下信息：
- 软件版本号
- 操作系统版本
- PDF文件特征（大小、页数、来源）
- 错误日志信息
- 使用的处理选项

---

**版本信息**：v2.0  
**更新日期**：2024年  
**开发者**：PDF书签工具团队 