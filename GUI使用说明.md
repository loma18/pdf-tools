# PDF自动书签工具 - GUI使用说明

## 功能介绍

这是一个带有图形界面的PDF自动书签工具，可以自动识别PDF文档中的目录结构并添加书签，支持中文PDF文档。

## 启动方式

### 方式一：双击批处理文件
- 双击 `run_gui.bat` 文件启动GUI界面

### 方式二：命令行启动
```bash
python pdf_bookmark_gui.py
```

## 界面说明

### 主要功能区域

1. **文件选择区域**
   - **选择PDF文件**: 点击"浏览"按钮选择需要处理的PDF文件
   - **输出文件**: 指定处理后的PDF文件保存路径（会自动生成建议名称）

2. **控制按钮**
   - **开始处理**: 开始处理选中的PDF文件
   - **清空**: 清空所有输入字段和日志
   - **退出**: 关闭程序

3. **进度显示**
   - 处理过程中会显示进度条动画
   - 状态栏显示当前处理状态

4. **日志区域**
   - 实时显示处理过程的详细信息
   - 包括找到的目录条目数量、验证结果等

## 使用步骤

1. **选择输入文件**
   - 点击"选择PDF文件"旁的"浏览"按钮
   - 选择需要添加书签的PDF文件

2. **确认输出路径**
   - 系统会自动生成输出文件名（原文件名_bookmarked.pdf）
   - 如需修改，可点击"输出文件"旁的"浏览"按钮重新选择

3. **开始处理**
   - 点击"开始处理"按钮
   - 等待处理完成，观察日志输出

4. **查看结果**
   - 处理完成后会弹出提示框
   - 生成的PDF文件会保存到指定位置

## 功能特点

### 智能目录识别
- 支持多种中文目录格式：
  - 第X章、第X节、第X部分
  - 数字编号（1.、1.1、1.1.1等，支持最多8层）
  - 中文数字（一、二、三）
  - 罗马数字、字母编号等

### 严格逻辑验证
- **顶层连续性验证**: 确保顶层数字连续（如1,2,3,4,5）
- **父子一致性验证**: 确保子级数字包含父级数字
- **排序合理性验证**: 确保同层级数字严格递增
- **前瞻性分析**: 避免逻辑冲突的书签

### 层级规范化
- 自动调整层级结构以符合PDF书签标准
- 重新排序条目确保父子关系正确
- PyMuPDF兼容性调整

## 处理结果

成功处理后，您将得到：
- 包含完整书签结构的PDF文件
- 支持多层级嵌套（最多8层）
- 逻辑清晰、层级正确的目录导航

## 注意事项

1. **文件格式**: 仅支持PDF格式文件
2. **文件权限**: 确保对输入和输出文件夹有读写权限
3. **处理时间**: 大文件处理时间较长，请耐心等待
4. **中文支持**: 完全支持中文PDF文档和目录

## 错误处理

如果处理失败，请检查：
- 输入文件是否存在且可访问
- 输出路径是否有写入权限
- PDF文件是否包含可识别的目录结构
- 查看日志区域的详细错误信息

## 技术支持

如遇问题，请查看日志区域的详细输出信息，或联系技术支持。 