<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PDF书签工具</title>
    <link rel="stylesheet" href="styles.css" />
  </head>

  <body>
    <div class="container">
      <!-- 窗口控制按钮 -->
      <div class="top-header">
        <div class="dragBar">PDF书签工具</div>
        <div class="window-controls">
          <button
            class="window-control-btn minimize-btn"
            id="minimize-btn"
            title="最小化"
          >
            −
          </button>
          <button
            class="window-control-btn maximize-btn"
            id="maximize-btn"
            title="最大化"
          >
            □
          </button>
          <button
            class="window-control-btn close-btn"
            id="close-btn"
            title="关闭"
          >
            ×
          </button>
        </div>
      </div>

      <div class="header">
        <h1>PDF书签工具</h1>
        <p class="subtitle">辅助生成书签目录</p>
      </div>
      <div class="body">
        <!-- 标签页导航 -->
        <div class="tab-nav">
          <button class="tab-button active" data-tab="markdown-assisted">
            markdown辅助加书签
          </button>
          <button
            class="tab-button"
            data-tab="add-bookmarks"
          >
            自动加书签
          </button>
          <button class="tab-button" data-tab="bookmark-file-assisted">
            书签文件辅助加书签
          </button>
          <button class="tab-button" data-tab="extract-bookmarks">
            自动提取书签
          </button>
        </div>

        <!-- 自动加书签标签页 -->
        <div id="add-bookmarks" class="tab-content">
          <div class="input-section">
            <div class="file-input-group">
              <label for="input-file">选择PDF文件：</label>
              <div class="file-input-wrapper">
                <input
                  type="text"
                  id="input-file"
                  placeholder="请选择PDF文件..."
                  readonly
                />
                <button id="browse-input" class="btn btn-secondary">
                  浏览...
                </button>
              </div>
            </div>

            <div class="file-input-group">
              <label for="output-file">输出文件路径：</label>
              <div class="file-input-wrapper">
                <input
                  type="text"
                  id="output-file"
                  placeholder="自动生成输出路径..."
                />
                <button id="browse-output" class="btn btn-secondary">
                  浏览...
                </button>
              </div>
            </div>
          </div>

          <div class="options-section">
            <h3>处理选项</h3>

            <!-- 基础过滤选项 -->
            <!-- <div class="option-category">
                    <h4>基础过滤</h4>
                    <div class="options-grid">
                        <div class="option-group" style="display: none;">
                            <label class="checkbox-label">
                                <input type="checkbox" id="enable-llm">
                                <span class="checkmark"></span>
                                启用大模型语义过滤
                            </label>
                        </div>

                        <div class="option-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="enable-enhanced-filter" checked>
                                <span class="checkmark"></span>
                                启用增强本地过滤
                            </label>
                        </div>
                    </div>
                </div> -->

            <!-- 字体过滤选项 -->
            <div class="option-category">
              <div class="options-grid">
                <div class="option-group" style="display: none;">
                  <label class="checkbox-label">
                    <input type="checkbox" id="enable-font-filter" checked />
                    <span class="checkmark"></span>
                    启用字体大小过滤
                  </label>
                </div>

                <div class="option-group">
                  <label for="font-threshold">字体大小阈值：</label>
                  <input
                    type="number"
                    id="font-threshold"
                    value="12"
                    step="0.1"
                    min="8"
                    max="72"
                  />
                </div>
              </div>
            </div>

            <!-- 标题格式过滤选项 -->
            <div class="option-category" style="display: none;">
              <h4>标题格式过滤</h4>
              <div class="options-grid">
                <div class="option-group">
                  <label class="checkbox-label">
                    <input type="checkbox" id="require-numeric-start" checked />
                    <span class="checkmark"></span>
                    书签必须以数字开头
                  </label>
                </div>
              </div>
              <div
                class="help-text"
                style="margin-top: 8px; font-size: 12px; color: #666"
              >
                启用后，只有以数字开头的标题才会被添加为书签（如"1.1 标题"、"2
                章节"等）。包含标题功能不受此选项影响。
              </div>
            </div>

            <!-- 调试选项 -->
            <div class="option-category" style="display: none">
              <h4>调试选项</h4>
              <div class="options-grid">
                <div class="option-group">
                  <label class="checkbox-label">
                    <input type="checkbox" id="enable-debug" />
                    <span class="checkmark"></span>
                    启用调试模式
                  </label>
                </div>
              </div>
            </div>
          </div>

          <!-- 手动控制模块 -->
          <div class="manual-control-section" style="display: none;">
            <h3>手动控制</h3>

            <div class="control-category">
              <h4>排除标题</h4>
              <p class="help-text">指定不应该加为书签的标题文本</p>
              <div class="title-list" id="exclude-titles">
                <!-- 动态添加的排除标题 -->
              </div>
              <div class="add-title-group">
                <input
                  type="text"
                  id="exclude-title-input"
                  placeholder="输入要排除的标题..."
                />
                <button
                  type="button"
                  id="add-exclude-title"
                  class="btn btn-secondary"
                >
                  添加排除
                </button>
              </div>
            </div>

            <div class="control-category">
              <h4>包含标题</h4>
              <p class="help-text">指定应该要加为书签的标题文本</p>
              <div class="title-list" id="include-titles">
                <!-- 动态添加的包含标题 -->
              </div>
              <div class="add-title-group">
                <input
                  type="text"
                  id="include-title-input"
                  placeholder="输入要包含的标题..."
                />
                <button
                  type="button"
                  id="add-include-title"
                  class="btn btn-secondary"
                >
                  添加包含
                </button>
              </div>
            </div>
          </div>

          <div class="action-section">
            <button id="start-process" class="btn btn-primary">
              <span class="btn-text">开始处理</span>
            </button>
            <button id="stop-process" class="btn btn-danger" disabled>
              <span class="btn-text">停止处理</span>
            </button>
            <button
              id="open-folder"
              class="btn btn-secondary"
              disabled
              style="display: none"
            >
              <span class="btn-text">打开文件夹</span>
            </button>
          </div>

          <div class="progress-section">
            <div class="progress-bar">
              <div class="progress-fill"></div>
            </div>
            <div class="progress-text">准备就绪</div>
          </div>

          <div class="log-section">
            <div class="log-header">
              <h3>处理日志</h3>
              <button id="clear-log" class="btn btn-secondary btn-small">
                清空日志
              </button>
            </div>
            <div id="log-output" class="log-output"></div>
          </div>
        </div>

        <!-- 书签文件辅助加书签标签页 -->
        <div id="bookmark-file-assisted" class="tab-content">
          <div class="input-section">
            <div class="file-input-group">
              <label for="bfa-input-file">选择PDF文件：</label>
              <div class="file-input-wrapper">
                <input
                  type="text"
                  id="bfa-input-file"
                  placeholder="请选择PDF文件..."
                  readonly
                />
                <button id="bfa-browse-input" class="btn btn-secondary">
                  浏览...
                </button>
              </div>
            </div>

            <div class="file-input-group">
              <label for="bfa-output-file">输出文件路径：</label>
              <div class="file-input-wrapper">
                <input
                  type="text"
                  id="bfa-output-file"
                  placeholder="自动生成输出路径..."
                />
                <button id="bfa-browse-output" class="btn btn-secondary">
                  浏览...
                </button>
              </div>
            </div>

            <div class="file-input-group">
              <label for="bfa-bookmark-file">书签文件：</label>
              <div class="file-input-wrapper">
                <input
                  type="text"
                  id="bfa-bookmark-file"
                  placeholder="选择书签文件..."
                  readonly
                />
                <button id="bfa-browse-bookmark" class="btn btn-secondary">
                  浏览...
                </button>
              </div>
              <div
                class="help-text"
                style="margin-top: 8px; font-size: 12px; color: #666"
              >
                支持 JSON 格式的书签文件。必填项。
              </div>
            </div>
          </div>

          <div class="action-section">
            <button id="bfa-start-process" class="btn btn-primary">
              <span class="btn-text">开始处理</span>
            </button>
            <button id="bfa-stop-process" class="btn btn-danger" disabled>
              <span class="btn-text">停止处理</span>
            </button>
            <button
              id="bfa-open-folder"
              class="btn btn-secondary"
              disabled
              style="display: none"
            >
              <span class="btn-text">打开文件夹</span>
            </button>
          </div>

          <div class="progress-section">
            <div class="progress-bar">
              <div class="progress-fill"></div>
            </div>
            <div class="progress-text">准备就绪</div>
          </div>

          <div class="log-section">
            <div class="log-header">
              <h3>处理日志</h3>
              <button id="bfa-clear-log" class="btn btn-secondary btn-small">
                清空日志
              </button>
            </div>
            <div id="bfa-log-output" class="log-output"></div>
          </div>
        </div>

        <!-- markdown辅助加书签标签页 -->
        <div id="markdown-assisted" class="tab-content active">
          <div class="input-section">
            <div class="file-input-group">
              <label for="ma-input-file">选择PDF文件：</label>
              <div class="file-input-wrapper">
                <input
                  type="text"
                  id="ma-input-file"
                  placeholder="请选择PDF文件..."
                  readonly
                />
                <button id="ma-browse-input" class="btn btn-secondary">
                  浏览...
                </button>
              </div>
            </div>

            <div class="file-input-group">
              <label for="ma-output-file">输出文件路径：</label>
              <div class="file-input-wrapper">
                <input
                  type="text"
                  id="ma-output-file"
                  placeholder="自动生成输出路径..."
                />
                <button id="ma-browse-output" class="btn btn-secondary">
                  浏览...
                </button>
              </div>
            </div>

            <div class="file-input-group">
              <label for="ma-markdown-file">Markdown文件：</label>
              <div class="file-input-wrapper">
                <input
                  type="text"
                  id="ma-markdown-file"
                  placeholder="选择Markdown文件..."
                  readonly
                />
                <button id="ma-browse-markdown" class="btn btn-secondary">
                  浏览...
                </button>
              </div>
              <div
                class="help-text"
                style="margin-top: 8px; font-size: 12px; color: #666"
              >
                从Markdown文件中解析标题结构，自动生成带数字前缀的书签。必填项。
              </div>
            </div>
          </div>

          <div class="preview-section" style="display: none">
            <h3>Markdown解析预览</h3>
            <div id="markdown-preview" class="markdown-preview">
              <p class="help-text">选择Markdown文件后将显示解析的标题结构</p>
            </div>
          </div>

          <div class="action-section">
            <button id="ma-start-process" class="btn btn-primary">
              <span class="btn-text">开始处理</span>
            </button>
            <button id="ma-stop-process" class="btn btn-danger" disabled>
              <span class="btn-text">停止处理</span>
            </button>
            <button
              id="ma-open-folder"
              class="btn btn-secondary"
              disabled
              style="display: none"
            >
              <span class="btn-text">打开文件夹</span>
            </button>
          </div>

          <div class="progress-section">
            <div class="progress-bar">
              <div class="progress-fill"></div>
            </div>
            <div class="progress-text">准备就绪</div>
          </div>

          <div class="log-section">
            <div class="log-header">
              <h3>处理日志</h3>
              <button id="ma-clear-log" class="btn btn-secondary btn-small">
                清空日志
              </button>
            </div>
            <div id="ma-log-output" class="log-output"></div>
          </div>
        </div>

        <!-- 自动提取书签标签页 -->
        <div id="extract-bookmarks" class="tab-content">
          <div class="input-section">
            <div class="file-input-group">
              <label for="extract-input-file">选择PDF文件：</label>
              <div class="file-input-wrapper">
                <input
                  type="text"
                  id="extract-input-file"
                  placeholder="请选择包含书签的PDF文件..."
                  readonly
                />
                <button id="browse-extract-input" class="btn btn-secondary">
                  浏览...
                </button>
              </div>
            </div>

            <div class="file-input-group">
              <label for="extract-output-file">书签文件路径：</label>
              <div class="file-input-wrapper">
                <input
                  type="text"
                  id="extract-output-file"
                  placeholder="自动生成书签文件路径..."
                />
                <button id="browse-extract-output" class="btn btn-secondary">
                  浏览...
                </button>
              </div>
            </div>
          </div>

          <div class="options-section" style="display: none">
            <h3>提取选项</h3>
            <div class="options-grid">
              <div class="option-group">
                <label class="checkbox-label">
                  <input type="checkbox" id="include-page-info" checked />
                  <span class="checkmark"></span>
                  包含页面信息
                </label>
              </div>

              <div class="option-group">
                <label class="checkbox-label">
                  <input type="checkbox" id="include-level-info" checked />
                  <span class="checkmark"></span>
                  包含层级信息
                </label>
              </div>

              <div class="option-group">
                <label for="export-format">导出格式：</label>
                <select id="export-format">
                  <option value="json">JSON</option>
                  <option value="txt">文本</option>
                  <option value="csv">CSV</option>
                </select>
              </div>
            </div>
          </div>

          <div class="action-section">
            <button id="start-extract" class="btn btn-primary">
              <span class="btn-text">开始提取</span>
            </button>
            <button id="stop-extract" class="btn btn-danger" disabled>
              <span class="btn-text">停止提取</span>
            </button>
            <button
              id="open-extract-folder"
              class="btn btn-secondary"
              disabled
              style="display: none"
            >
              <span class="btn-text">打开文件夹</span>
            </button>
          </div>

          <div class="progress-section">
            <div class="progress-bar">
              <div class="progress-fill"></div>
            </div>
            <div class="progress-text">准备就绪</div>
          </div>

          <div class="log-section">
            <div class="log-header">
              <h3>提取日志</h3>
              <button
                id="clear-extract-log"
                class="btn btn-secondary btn-small"
              >
                清空日志
              </button>
            </div>
            <div id="extract-log-output" class="log-output"></div>
          </div>

          <div class="preview-section" style="display: none">
            <h3>书签预览</h3>
            <div id="bookmark-preview" class="bookmark-preview"></div>
          </div>
        </div>

        <div class="footer">
          <div class="app-info">
            <span id="app-version">v1.0.0</span>
            <span class="separator">|</span>
            <span>PDF书签工具</span>
            <span class="separator">|</span>
            <button id="diagnose-env" class="btn btn-link">环境诊断</button>
          </div>
        </div>

        <!-- 诊断信息模态框 -->
        <div id="diagnostic-modal" class="modal" style="display: none">
          <div class="modal-content">
            <div class="modal-header">
              <h3>环境诊断信息</h3>
              <span class="modal-close">&times;</span>
            </div>
            <div class="modal-body">
              <div id="diagnostic-content">
                <p>正在检查环境...</p>
              </div>
            </div>
            <div class="modal-footer">
              <button class="btn btn-secondary" onclick="copyDiagnostics()">
                复制诊断信息
              </button>
              <button class="btn btn-primary" onclick="closeDiagnosticModal()">
                关闭
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script src="renderer.js"></script>
  </body>
</html>
